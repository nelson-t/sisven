** Programa para encontrar una variedad de excepciones
CLEAR

? "VERIFICANDO NR's"

CLOSE DATA

SELECT 1
USE V_DOC_HD ORDER NR

SELECT 2
USE V_DOC_LN ORDER NR
SET RELATION TO LD_EMPR+LD_TIPO+LD_NRO INTO V_DOC_HD
SET FILTER TO LD_TIPO='R'

GO TOP
DO WHILE .NOT. EOF()
  
  IF LD_ESTADO<>V_DOC_HD.HD_ESTADO
     WAIT 'NR: '+LD_TIPO+'-'+LD_NRO+' '+DTOC(LD_FECHA)+'  ESTADO CABEZA: '+V_DOC_HD.HD_ESTADO+'LINEA: ' +LD_ESTADO+ ' [ENTER] PARA CORREGIR [ESC] CONTINUAR'
  ENDIF
  
  IF LASTKEY()=13
     REPLACE LD_ESTADO WITH V_DOC_HD.HD_ESTADO
  ENDIF

  SKIP
  
ENDDO

CLOSE ALL


? "VERIFICANDO DOCS's"

CLOSE DATA

SELECT 1
USE V_DOC_HD ORDER CORRE

SELECT 2
USE V_DOC_LN ORDER CORRE
SET RELATION TO LD_EMPR+LD_ALM+LD_TIPO+LD_NRO INTO V_DOC_HD
SET FILTER TO LD_TIPO<>'R'

GO TOP
DO WHILE .NOT. EOF()
  
  IF LD_ESTADO<>V_DOC_HD.HD_ESTADO
     WAIT 'DOC: '+LD_TIPO+'-'+LD_NRO+' '+DTOC(LD_FECHA)+'  ESTADO CABEZA: '+V_DOC_HD.HD_ESTADO+'LINEA: ' +LD_ESTADO+ ' [ENTER] PARA CORREGIR [ESC] CONTINUAR'
  ENDIF
  
  IF LASTKEY()=13
     REPLACE LD_ESTADO WITH V_DOC_HD.HD_ESTADO
  ENDIF

  SKIP
  
ENDDO

CLOSE ALL

* ESTADO DE FACTURAS

? "VERIFICANDO FACTURAS"

CLOSE DATA

SELECT 1
USE V_FAC_HD ORDER CORRE

SELECT 2
USE V_FAC_LN ORDER CORRE
SET RELATION TO LF_EMPR+IIF(LF_TIPO$"RO","F",LF_TIPO)+LF_NRO INTO V_FAC_HD

GO TOP
DO WHILE .NOT. EOF()
  
  IF LF_ESTADO<>V_FAC_HD.HF_ESTADO
     WAIT 'FACTURA: '+LF_NRO+' '+DTOC(LF_FECHA)+'  ESTADO CABEZA: '+V_FAC_HD.HF_ESTADO+'LINEA: ' +LF_ESTADO+ ' [ENTER] PARA CORREGIR [ESC] CONTINUAR'
  ENDIF
  
  IF LASTKEY()=13
     REPLACE LF_ESTADO WITH V_FAC_HD.HF_ESTADO
  ENDIF

  SKIP
  
ENDDO

CLOSE ALL