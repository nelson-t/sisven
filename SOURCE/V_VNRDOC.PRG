FUNCTION V_VNRDOC
*****************
*VERIFICA SI NRO DE DOCUMENTO YA EXISTE
PARAMETER EMPRE, TIPO , NRO, DOSIF

SET EXACT ON

DO CASE
  case tipo="R"  && NOTA DE REMISION
     SELECT 1
     USE V_DOC_HD ORDER NR
     SEEK EMPRE+TIPO+NRO
  case tipo="F"  && FACTURA
     SELECT 1
     USE V_FAC_HD ORDER CORRE
     SEEK EMPRE+"F"+STR(DOSIF,4)+NRO
  case tipo="X" OR tipo="Y"  && NOTA CR o DB
     SELECT 1
     USE V_FAC_HD ORDER CORRE
     SEEK EMPRE+TIPO+"   0"+NRO
  case tipo="P"  && PEDIDO
     SELECT 1
     USE V_PED_HD ORDER CORRE
     SEEK EMPRE+NRO
  OTHERWISE
	 SET EXACT OFF
     RETURN .F.  
ENDCASE

SET EXACT OFF
IF FOUND()
  USE
  RETURN .T. &&EXISTE
ENDIF

USE
RETURN .F. &&NO EXISTE