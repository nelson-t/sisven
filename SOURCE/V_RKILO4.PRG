PARAMETER T_LINEAS, FAC_LN_IDX, FAC_LN_DBF

SET EXCLU OFF
CLOSE DATA
CLEAR
SET TALK OFF

SELECT 1
USE (T_LINEAS) ORDER LINEA ALIAS V_LINEAK

SELECT 2
USE V_TC ORDER FECHA

SELECT 3
USE V_DOC_LN ORDER CORRE

SELECT 4
USE V_ITEMS  ORDER PART
SET RELATION TO IT_EMPR+SUBSTR(IT_LINEA,1,2)+' ' INTO V_LINEAK

SELECT 5
USE V_AREAS ORDER CODIGO ASCENDING

SELECT 6
USE V_FAC_HD ORDER CORRE

SELECT 7
USE V_FAC_LN ORDER CORRE
SET RELATION TO LF_EMPR+IIF(LF_TIPO$'RO','F',LF_TIPO)+LF_NRO INTO V_FAC_HD ADDITIVE
COPY TO (FAC_LN_DBF) WITH CDX ;
                     FOR LF_EMPR=EMPRESA .AND. ;
                     BETWEEN(LF_FECHA,FECHAI,FECHAF) .AND. ;
				     LEN(ALLTRIM(V_FAC_HD.HF_AREA))<>0 .AND. ;
				     LF_ESTADO<>'A'

SELECT 8
USE FAC_LN ORDER CORRE
SET RELATION TO LF_EMPR+LF_PART INTO V_ITEMS
INDEX ON LF_EMPR+V_ITEMS.IT_LINEA+LF_PART TO (FAC_LN_IDX)
SET RELATION TO DTOS(LF_FECHA) INTO V_TC ADDITIVE

SCAN
	SELECT V_FAC_HD
	SEEK FAC_LN.LF_EMPR+IIF(FAC_LN.LF_TIPO$'RO','F',FAC_LN.LF_TIPO)+FAC_LN.LF_NRO
	SELECT FAC_LN
	REPLACE FAC_LN.LF_COD_CL WITH V_FAC_HD.HF_AREA
ENDSCAN

SELECT FAC_LN
SET ORDER TO CLI_PART
SET RELATION TO FAC_LN.LF_COD_CL INTO V_AREAS ADDITIVE


