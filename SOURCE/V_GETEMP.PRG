PROCEDURE V_GETEMP
******************
PUBLIC EMPRESA, MI_EMPRESA, EMPCIUD, INI_GEST

SET DELE ON
SET EXCLU OFF

SELECT 0
USE V_EMPR ORDER EMPR

EMPRESA=EM_EMPR
MI_EMPRESA=alltrim(EM_DESCR)
EMPCIUD=alltrim(EM_CIUDAD)
INI_GEST=EM_FECHA

COUNT TO COUNTER

IF COUNTER>1
  * MUESTRA EMPRESAS
  ACTIVATE SCREEN
  CLEAR
  @ 6,5,19,78 BOX REPLICATE("°",8)+"°"
  @ 6,5 FILL TO 19,78 COLOR N+/N
  DEFINE WINDOW MI_EMPR FROM 5,3 TO 18,76 DOUBLE FILL CHR(177) TITLE '[ESC] PARA SALIR' 
  ACTIVATE WINDOW MI_EMPR
  @ 3,0
  GO TOP
  COUNTER=0
  DO WHILE .NOT. EOF()
    @ 3+counter,33 SAY ' '+EM_EMPR+'-'+EM_DESCR COLOR W/B
    counter=counter+1
    SKIP
  ENDDO 
  @ 2,32 TO 3+COUNTER,65 DOUBLE COLOR W/B
  
  * PIDE Y VERIFICA EMPRESA
  DO WHILE .T. .AND. LASTKEY()<>27
    @ 3, 7 SAY ' SELECCIONE EMPRESA:' GET EMPRESA PICTURE '9' COLOR W/B
    READ
    SEEK EMPRESA  
    IF .NOT. EOF()
      EMPCIUD=alltrim(EM_CIUDAD)
      MI_EMPRESA=alltrim(EM_DESCR)
      INI_GEST=EM_FECHA
      EXIT
    ENDIF
  ENDDO
  RELEASE WINDOW MI_EMPR  
  CLEAR
ENDIF  

USE

RETURN