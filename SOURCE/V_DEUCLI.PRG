******************
FUNCTION  V_DEUCLI
******************
INI_GEST={01/04/95}

DEBE =0
HABER=0
SALDO=0

SELECT V_CLIENT


SELECT 0
USE V_FAC_HD ORDER ESTADOS

SEEK V_CLIENT.CL_EMPR+V_CLIENT.CL_COD_CL

DO WHILE .NOT. EOF() .AND. V_CLIENT.CL_EMPR+V_CLIENT.CL_COD_CL=HF_EMPR+HF_COD_CL
  IF HF_ESTADO<>'A' .AND. HF_TIPO<>'O'
    TDEBE =0
    THABER=0
    DO CASE
      CASE HF_TIPO='O'  && FACTURA AL CONTADO
        TDEBE =hf_importe-HF_DSCTO_M-ROUND(hf_importe*(HF_DSCTO_P/100),2)+hf_fletes+hf_embala+hf_otros 
        THABER=hf_importe-HF_DSCTO_M-ROUND(hf_importe*(HF_DSCTO_P/100),2)+hf_fletes+hf_embala+hf_otros 
      CASE HF_TIPO='R'  && FACTURA AL CREDITO
        TDEBE=hf_importe-HF_DSCTO_M-ROUND(hf_importe*(HF_DSCTO_P/100),2)+hf_fletes+hf_embala+hf_otros 
        THABER=0 
      CASE HF_TIPO='X'  && NOTA DE CREDITO
        TDEBE=0
        THABER=hf_importe
      CASE HF_TIPO='Y'  && NOTA DE DEBITO
        TDEBE=HF_IMPORTE
        THABER=0
      CASE HF_TIPO='Z'  && COMUN. INTERNA
        TDEBE=HF_IMPORTE
        THABER=0
    ENDCASE
    DEBE =DEBE +TDEBE
    HABER=HABER+THABER
  ENDIF
  SELECT V_FAC_HD 
  SKIP
ENDDO

SELECT V_FAC_HD
USE

USE V_REC_HD ORDER ESTADOS

SEEK V_CLIENT.CL_EMPR+V_CLIENT.CL_COD_CL
DO WHILE .NOT. EOF() .AND. V_CLIENT.CL_EMPR+V_CLIENT.CL_COD_CL=HR_EMPR+HR_COD_CL
  IF HR_ESTADO<>'A' 
    TDEBE=0
    THABER=HR_TOT_BS
  ENDIF
  DEBE =DEBE +TDEBE
  HABER=HABER+THABER
  SELECT V_REC_HD
  SKIP
ENDDO

SELECT V_REC_HD
USE

SELECT V_CLIENT 

REPLACE CL_SALD_DB WITH DEBE, CL_SALD_HB WITH HABER, ;
        CL_SALD_AC WITH CL_SALD_AN+DEBE-HABER
        
RETURN CL_SALD_ACT