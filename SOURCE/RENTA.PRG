SET EXCLUSIVE OFF
SET CLOCK ON
SET DATE TO DMY
SET EXACT OFF
SET CENTURY ON
PUBLIC RUTA
PUBLIC SUC
SUC="0"

SELECT 1
USE V_FAC_HD ORDER NRO_FAC 

SELECT 2
USE DOSIF

SELE 2
GO TOP

DO WHILE NOT(EOF())
	IF SUCURSAL=SUC
	   ORD=NROORD
	   DOS=DOSIF
	   NROI=DESDE
	   NROF=HASTA
	   fecha=fini
	   SELE 1
	   GO TOP
	   LOCATE FOR (VAL(RIGHT(HF_NRO,5))>=VAL(RIGHT(NROI,5)) .AND. VAL(RIGHT(HF_NRO,5))<=VAL(RIGHT(NROF,5)))
		DO WHILE FOUND()
		 IF HF_TIPO<>"Z"
			REPLACE HF_ALFANRO WITH DOS 
			REPLACE HF_NRO_ORD WITH ORD 
		 ENDIF
	    CONTINUE
	   ENDDO
	ENDIF
	SELE 2
	IF NOT(EOF())
		 SKIP
	ENDIF
ENDDO
