******************
PROCEDURE V_PRO_OP
******************
OPCION=1

DO V_PRO_O.SPR

DO CASE
  CASE LASTKEY()<>27 .AND. OPCION=1
*   IMPRIME PROFORMA
    DO PRO_IMPR

  CASE LASTKEY()<>27 .AND. OPCION=2

  CASE LASTKEY()<>27 .AND. OPCION=3

  CASE LASTKEY()=27 .OR. OPCION=4
*   SALE DEL MENU DE OPCIONES
ENDCASE

RETURN

PROCEDURE PRO_IMPR
******************
SELECT V_PRO_HD
IF HP_MONEDA=' '
  MONEDA=1
  DO V_BS_US.SPR
  IF MONEDA=1
    IF LOCK()
      REPLACE HP_MONEDA WITH 'B'
    ENDIF
  ELSE
    IF LOCK()
      REPLACE HP_MONEDA WITH 'U'
    ENDIF
  ENDIF
ENDIF
TIPO_C=V_TC.TC_MONTO

SELECT V_PRO_LN
SEEK V_PRO_HD.HP_EMPR+V_PRO_HD.HP_NRO     
TEMP_FILE='V:'+SYS(3)+'.PED'
_PADVANCE='LINEFEED'
REPORT FORM V_PR_FOR NOCONSOLE REST WHILE V_PRO_HD.HP_EMPR+V_PRO_HD.HP_NRO=LP_EMPR+LP_NRO TO FILE (TEMP_FILE)
_PADVANCE='FORMFEED'
! COPY &TEMP_FILE LPT1:
DELETE FILE (TEMP_FILE)
MENSAJE1='PROFORMA NRO.:'+V_PRO_HD.HP_NRO+' HA SIDO IMPRESA'
MENSAJE2=''
DO V_MENSAJ.SPR
RETURN
