********************************************************
* PROGRAMADO POR: MARTIN FABBRI
* DESCRIPCION:    PROGRAMA DE ABMS DE LA TABLA V_AREAS
********************************************************

CLOSE DATA
SET DELE ON
SET TALK OFF
SET EXCLU OFF
SET EXACT OFF

CLEAR
PRIMERA=' '

SELECT 1
USE V_AREAS ORDER CODIGO
GO BOTT
CLEAR
DEFINE WINDOW  MOD_CODIGO FROM 0,19 TO 21,63

ON KEY LABEL F10 KEYBOARD CHR(23)
ON KEY LABEL F4  KEYBOARD CHR(14)
ON KEY LABEL F8  KEYBOARD CHR(20)

@ 22,5 to 24,75 DOUBLE

@ 23,12 SAY '[F4]-ADICIONA REGISTRO  [F8]-BORRA REGISTRO  [F10]-SALIR' COLOR GR+/B

BROW FIELDS A_COD:H='CODIGO ':V=ES_UNICO(A_COD):E='YA EXISTE UN AREA CON ESE CODIGO !!!', ;
            A_SIG:H='SIGLA ', A_DES:H='DESCRIPCION';
     WINDOW MOD_CODIGO TITLE 'AREAS DE ESPECIALIZACION'

CLOSE DATA
RELEASE WINDOW MOD_TC
CLEAR
RETURN

FUNCTION ES_UNICO
*****************
	PARAMETER COD
	
	RESULT = .F.
	MI_REC = RECNO()
	SELECT V_AREAS
	REPLACE A_COD WITH ' '
	SEEK COD
	IF FOUND()
  		GO MI_REC
  		RESULT = .F.
  	ELSE
  		GO MI_REC
  		REPLACE A_COD WITH COD
  		RESULT = .T.
  	ENDIF      
RETURN RESULT