******************
PROCEDURE V_POS_OP
******************
OPCION=1
DO V_NR_O.SPR

DO CASE
  CASE LASTKEY()<>27 .AND. OPCION=1
*   ELABORA FACTURA
	IF .NOT. V_USRAUT(USER,"NOTAS_REM",2) .OR. .NOT. V_USRAUT(USER,"FACTURAS",2)
  		RETURN
	ENDIF

    DO V_NR_FAC

  CASE LASTKEY()<>27 .AND. OPCION=2
*   IMPRIME COPIAS DE LA REMISION
    MENSAJE1='SE IMPRIMIRA COPIA DE LA NOTA DE REMISION' 
    MENSAJE2='[ENTER] PARA CONTINUAR, [ESC] PARA CANCELAR IMPRESION'
    DO V_MENSAJ.SPR
    IF LASTKEY()<>27
      DO NR_IMPR_O
    ENDIF

  CASE LASTKEY()<>27 .AND. OPCION=3
*   IMPRIME REMISION VALORADA
*   !!!! MUCHO CUIDADO CON EL CORRELATIVO PREIMPRESO !!!!
    MENSAJE1='CUIDADO, SE IMPRIMIRA NOTA DE REMISION, VERIFIQUE FORMULARIO' 
    MENSAJE2='[ENTER] PARA CONTINUAR, [ESC] PARA CANCELAR IMPRESION'
    DO V_MENSAJ.SPR
    IF LASTKEY()<>27
      DO NR_IMPR_v
    ENDIF
  CASE LASTKEY()=27  .OR.  OPCION=4
ENDCASE
DO NR_VER
RETURN

PROCEDURE NR_IMPR_V
*******************
SELECT V_DOC_LN
SET ORDER TO NR
SEEK V_DOC_HD.HD_EMPR+V_DOC_HD.HD_TIPO+V_DOC_HD.HD_NRO     
TEMP_FILE='..\TMP\'+SYS(3)+'.NR'
_PADVANCE='LINEFEED'
REPORT FORM V_NR_FO2 NOCONSOLE REST WHILE V_DOC_HD.HD_EMPR+V_DOC_HD.HD_TIPO+V_DOC_HD.HD_NRO=LD_EMPR+LD_TIPO+LD_NRO TO FILE (TEMP_FILE)
_PADVANCE='FORMFEED'
! COPY &TEMP_FILE lpt1:
*modi comm (TEMP_FILE)
MENSAJE1='NOTA DE REMISION NRO.:'+V_DOC_HD.HD_NRO+' HA SIDO IMPRESA'
MENSAJE2=''
DO V_MENSAJ.SPR
DELETE FILE (TEMP_FILE)
RETURN

PROCEDURE NR_IMPR_O
*******************
SELECT V_DOC_LN
SET ORDER TO NR
SEEK V_DOC_HD.HD_EMPR+V_DOC_HD.HD_TIPO+V_DOC_HD.HD_NRO     
TEMP_FILE='..\TMP\'+SYS(3)+'.NR'
_PADVANCE='LINEFEED'
REPORT FORM V_NR_FOR NOCONSOLE REST WHILE V_DOC_HD.HD_EMPR+V_DOC_HD.HD_TIPO+V_DOC_HD.HD_NRO=LD_EMPR+LD_TIPO+LD_NRO TO FILE (TEMP_FILE)
_PADVANCE='FORMFEED'
! COPY &TEMP_FILE lpt1:
*modi comm (TEMP_FILE)
MENSAJE1='NOTA DE REMISION NRO.:'+V_DOC_HD.HD_NRO+' HA SIDO IMPRESA'
MENSAJE2=''
DO V_MENSAJ.SPR
DELETE FILE (TEMP_FILE)
RETURN
