FUNCTION V_GETDDO
*****************
PARAMETER NDOSIF, EMP

CERRAR_DOSIF=.F.

* GET DOSIF DATA
IF !USED("V_DOSIFI")
  SELECT 0
  USE V_DOSIFI ORDER NRO
  CERRAR_DOSIF=.T.
ENDIF

SELECT V_DOSIFI
LOCATE FOR V_DOSIFI.EMPR=EMP .AND. V_DOSIFI.NRO=NDOSIF

IF EOF()
  WAIT "NO SE ENCONTRO DOSIFICACION NRO:"+NDOSIF+"... SALIENDO" WINDOW TIMEOUT 2
  IF CERRAR_DOSIF
    USE
  ENDIF
  
  RETURN .F.
ELSE
  PUBLIC _ACTIVA,_DE_FECHA, _A_FECHA, _NRO_AUT,_LLAVE,_RAZONSOC, _DE, _NIT, _SUCURSAL, ;
  _DIRECCIO1, _DIRECCIO2, _DIRECCIO3, _TEXTO_SIN, _TEXTO_453, ;
  _ACTIV_EC1, _ACTIV_EC2, _ACTIV_EC3, _MENSAJE

  _ACTIVA     = v_dosifi.ACTIVA    
  _DE_FECHA   = v_dosifi.DE_FECHA  
  _A_FECHA    = v_dosifi.A_FECHA   
  _NRO_AUT    = v_dosifi.NRO_AUT   
  _LLAVE      = v_dosifi.LLAVE     
  _RAZONSOC   = v_dosifi.RAZONSOC  
  _DE         = v_dosifi.DE        
  _NIT        = v_dosifi.NIT       
  _SUCURSAL   = v_dosifi.SUCURSAL  
  _DIRECCIO1 = v_dosifi.DIRECCION1
  _DIRECCIO2 = v_dosifi.DIRECCION2
  _DIRECCIO3 = v_dosifi.DIRECCION3
  _TEXTO_SIN  = v_dosifi.TEXTO_SIN 
  _TEXTO_453  = v_dosifi.TEXTO_453 
  _ACTIV_EC1 = v_dosifi.ACTIV_ECO1
  _ACTIV_EC2 = v_dosifi.ACTIV_ECO2
  _ACTIV_EC3 = v_dosifi.ACTIV_ECO3
  _MENSAJE    = v_dosifi.MENSAJE   

  IF CERRAR_DOSIF
    USE
  ENDIF

  RETURN .T.
ENDIF

***FIN  
  
 