*****************
FUNCTION V_NEXT_N
*****************
PARAMETER EMP,CUAL
CURRENT=SELECT()
ON ERROR USE V_CORRE IN 0 ORDER EMPRESA
SELECT V_CORRE
ON ERROR
SEEK EMP
IF EOF()
  SELECT (CURRENT)
  RETURN '000000'
ENDIF  
DO CASE
  CASE CUAL='HDR'
    PROXIMO=VAL(CO_HDR)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_HDR WITH PROXIMO
    ENDIF
  CASE CUAL='ARCH'
    PROXIMO=VAL(CO_ARCH)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_ARCH WITH PROXIMO
    ENDIF
  CASE CUAL='PED'
    PROXIMO=VAL(CO_PED)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_PED WITH PROXIMO
    ENDIF
  CASE CUAL='FAC'
    PROXIMO=VAL(CO_FACT)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_FACT WITH PROXIMO
    ENDIF
  CASE CUAL='NR'
    PROXIMO=VAL(CO_NR)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_NR WITH PROXIMO
    ENDIF
  CASE CUAL='NN'
    PROXIMO=VAL(CO_NR_O)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_NR_O WITH PROXIMO
    ENDIF
  CASE CUAL='NC'
    PROXIMO=VAL(CO_NC)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_NC WITH PROXIMO
    ENDIF
 CASE CUAL='CI'
    PROXIMO=VAL(CO_CI)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_CI WITH PROXIMO
    ENDIF
  CASE CUAL='PRO'
    PROXIMO=VAL(CO_PROFORM)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_PROFORM WITH PROXIMO
    ENDIF
  CASE CUAL='REC'
    PROXIMO=VAL(CO_REC)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_REC WITH PROXIMO
    ENDIF
  CASE CUAL='TRAN'
    PROXIMO=VAL(CO_TRA)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_TRA WITH PROXIMO
    ENDIF
  CASE CUAL='TRAS'
    PROXIMO=VAL(CO_TRASP)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_TRASP WITH PROXIMO
    ENDIF
  CASE CUAL='NI'
    PROXIMO=VAL(CO_NI)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_NI WITH PROXIMO
    ENDIF
  CASE CUAL='IM'
    PROXIMO=VAL(CO_IMPORT)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_IMPORT WITH PROXIMO
    ENDIF
  CASE CUAL='CL'
    PROXIMO=VAL(CO_COMPRAL)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_COMPRAL WITH PROXIMO
    ENDIF
   CASE CUAL='ND'
    PROXIMO=VAL(CO_ND)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_ND WITH PROXIMO
    ENDIF
  CASE CUAL='NE'
    PROXIMO=VAL(CO_NE)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_NE WITH PROXIMO
    ENDIF
  CASE CUAL='INV'
    PROXIMO=VAL(CO_INV)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_INV WITH PROXIMO
    ENDIF
  CASE CUAL='DEV'
    PROXIMO=VAL(CO_DEV)+1
    PROXIMO=RIGHT('00000'+ALLTRIM(STR(PROXIMO)),6)
    IF LOCK()
      REPLACE CO_DEV WITH PROXIMO
    ENDIF
ENDCASE    
UNLOCK
FLUSH
USE
USE V_CORRE ORDER EMPRESA
SELECT (CURRENT)
RETURN PROXIMO