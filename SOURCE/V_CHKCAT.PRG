FUNCTION V_CHKCAT
*****************
PARAMETER CCOD, NOMVARX, TIPOVARX, NOMVARM
*CCOD=CODIGO DE CATEGORIA
*NOMVARX=NOMBRE DE CAMPO DE *BD* A ACTUALIZAR
*TIPOVARX=TIPO DE LA VARIABLE (DB o MM)
*NOMVARM =NOMBRE DE VARIABLE EN *MEMORIA* A ACTUALIZAR

CURRENT=SELECT()
CERRARDBF=.F.
CATDESCR =''

IF SELECT("V_CATEGO")=0
  CERRARDBF=.T.
  SELECT 0
  USE V_CATEGO ORDER CATEGO
ENDIF
  
SELECT V_CATEGO
SEEK EMPRESA+CCOD
IF FOUND()
  CATDESCR= CA_DESCR
ELSE
  SELECT V_CATEGO
  *-  DEFINIR & ACTIVAR POPUP -*
  DEFINE POPUP GETCAT FROM 8,20 TO 20,60 PROMPT FIELD substr(CA_DESCR,1,30)+'-'+CA_CATEGO ;
 		 TITLE 'SELECCIONE CATEGORIA CON [ENTER]' 
  ON SELECTION POPUP GETCAT DEACTIVATE POPUP
  * SET ORDER TO xxx
  ACTIVATE POPUP GETCAT
  *SET ORDER TO yyy
  CCOD=SUBSTR(PROMPT(),32,1)
  SEEK EMPRESA+CCOD
  IF FOUND()
    CATDESCR=CA_DESCR
  ENDIF
  RELEASE POPUP GETCAT
ENDIF    
IF CERRARDBF
  SELECT V_CATEGO
  USE
ENDIF

SELECT (CURRENT)

IF .NOT. ''=NOMVARX
  IF TIPOVARX="DB"
    REPLACE (NOMVARX) WITH CCOD
  ELSE
    STORE CCOD TO (NOMVARX) 
  ENDIF
ENDIF

IF .NOT. ''=NOMVARM
  STORE CATDESCR TO (NOMVARM) 
ENDIF

RETURN .T.