FUNCTION V_VERHOE
******************
*IMPLEMENTACION VERHOEFF
PARAMETER CIFRA
*CIFRA=alltrim(str(cifra))

MULSTRING="0,1,2,3,4,5,6,7,8,9|1,2,3,4,0,6,7,8,9,5|2,3,4,0,1,7,8,9,5,6|3,4,0,1,2,8,9,5,6,7|4,0,1,2,3,9,5,6,7,8|5,9,8,7,6,0,4,3,2,1|6,5,9,8,7,1,0,4,3,2|7,6,5,9,8,2,1,0,4,3|8,7,6,5,9,3,2,1,0,4|9,8,7,6,5,4,3,2,1,0" 

DIMENSION MUL(10,10)
INDICE=1
FOR I=1 TO 10 STEP 1
   FOR J=1 TO 10 STEP 1
    STORE substr(MULSTRING,INDICE,1) TO MUL(I, J)
    INDICE=INDICE+2
   ENDFOR
ENDFOR

*DISPLAY MEMORY LIKE MUL

PERSTRING="0,1,2,3,4,5,6,7,8,9|1,5,7,6,2,8,3,0,9,4|5,8,0,3,7,9,6,1,4,2|8,9,1,6,0,4,3,5,2,7|9,4,5,3,1,2,6,8,7,0|4,2,8,6,5,7,3,9,0,1|2,7,9,3,8,0,6,4,1,5|7,0,4,6,9,1,3,2,5,8"

DIMENSION PER(8,10)
INDICE=1
FOR I=1 TO 8 STEP 1
   FOR J=1 TO 10 STEP 1
    STORE substr(PERSTRING,INDICE,1) TO PER(I, J)
    INDICE=INDICE+2
   ENDFOR
ENDFOR

*DISPLAY MEMORY LIKE PER

DIMENSION INV(10)
STORE 0 TO INV(1)
STORE 4 TO INV(2)
STORE 3 TO INV(3)
STORE 2 TO INV(4)
STORE 1 TO INV(5)
STORE 5 TO INV(6)
STORE 6 TO INV(7)
STORE 7 TO INV(8)
STORE 8 TO INV(9)
STORE 9 TO INV(10)

***INVIERTE CIFRA
LENCIFRA=LEN(CIFRA)

REVCIFRA=""
FOR I=0 TO LENCIFRA-1
  REVCIFRA=REVCIFRA+SUBSTR(CIFRA,LENCIFRA-I,1)
ENDFOR 

CHECK=0
FOR I=0 TO LENCIFRA-1
   TEMP=PER[((I+1)%8)+1 , VAL(substr(REVCIFRA,I+1,1))+1 ]
   STORE VAL(MUL(CHECK+1,val(TEMP)+1)) to CHECK  
ENDFOR

RETURN alltrim(str(INV(CHECK+1)))