FUNCTION V_VNDUPL
*****************
PARAMETER TIPO,NDOSI
*VERIFICA DUPLICADOS AL INTENTAR GENERAR DOCUMENTO
*ASUME QUE ARCHIVO CORRELATIVO ESTA ABIERTO, SINO LO ABRE Y CIERRA
*ASUME QUE TABLA DE FACTURAS, NR, O ETC esta abierto

CURRNT=SELECT()

SELECT v_corre
LOCATE FOR CO_EMPR=EMPRESA
IF .NOT. FOUND()
	SELECT CURRNT
	RETURN .F.
ENDIF	

RESUL=.T.

DO CASE
  CASE TIPO="FAC" 		&&FACTURA
	SELECT V_FAC_HD
	LOCATE FOR HF_EMPR=EMPRESA AND HF_TIPO$"RO" AND HF_NDOSIF=NDOSI AND VAL(HF_NRO)=VAL(V_CORRE.CO_FACT)+1
	IF .NOT. FOUND()
	    RESUL=.F.
	ELSE
		WAIT "LA FACTURA QUE INTENTA GENERAR, YA EXISTE: "+STR(HF_NDOSIF,4)+"-"+HF_NRO WINDOW
		WAIT "VERIFIQUE LOS DATOS DE CORRELATIVOS." WINDOW
	ENDIF
  CASE TIPO="NRC"  		&&NR CREDITO
	SELECT V_DOC_HD
	LOCATE FOR HD_EMPR=EMPRESA AND HD_TIPO="R" AND VAL(HD_NRO)=VAL(V_CORRE.CO_NR)+1
	IF .NOT. FOUND()
	    RESUL=.F.
	ELSE
		WAIT "LA N.R. QUE INTENTA GENERAR, YA EXISTE: "+HD_NRO WINDOW
		WAIT "VERIFIQUE LOS DATOS DE CORRELATIVOS." WINDOW
	ENDIF

  CASE TIPO="PED"  		&&COTIZACION/PEDIDO
	SELECT V_PED_HD
	LOCATE FOR HP_EMPR=EMPRESA .AND. VAL(HP_NRO)=VAL(V_CORRE.CO_PED)+1

	IF .NOT. FOUND()
	    RESUL=.F.
	ELSE
		WAIT "LA COTIZACION/PEDIDO QUE INTENTA GENERAR, YA EXISTE: "+HP_NRO WINDOW
		WAIT "VERIFIQUE LOS DATOS DE CORRELATIVOS." WINDOW
	ENDIF
	
ENDCASE

SELECT (CURRNT)

RETURN RESUL
		